<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Efficiency Scorecard: {{CompanyName}}</title>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    /* CSS Reset and Base Styles */
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    /* CSS Variables */
    :root {
      /* Color Palette */
      --accent-green: #20E28F;
      --primary-dark: #103138;
      --white: #FFFFFF;
      --light-mint: #F3FDF5;
      
      /* Tier Colors */
      --dabbler-color: #FEC401;
      --dabbler-light: #FFFBE5;
      --enabler-color: #FE7F01;
      --enabler-light: #FFF1E5;
      --leader-color: #01CEFE;
      --leader-light: #E5F9FF;
      
      /* Typography Scale (in pt for WeasyPrint) */
      --text-xs: 8pt;
      --text-sm: 9pt;
      --text-base: 11pt;
      --text-lg: 13pt;
      --text-xl: 16pt;
      --text-2xl: 18pt;
      --text-3xl: 22pt;
      --text-4xl: 32pt;
      
      /* Spacing Scale (in mm for WeasyPrint) */
      --space-1: 2mm;
      --space-2: 4mm;
      --space-3: 6mm;
      --space-4: 8mm;
      --space-5: 12mm;
      --space-6: 16mm;
      --space-8: 24mm;
    }
    
    /* Core Typography */
    body {
      font-family: 'Plus Jakarta Sans', Arial, sans-serif;
      line-height: 1.5;
      color: var(--primary-dark);
      background-color: var(--white);
      font-size: var(--text-base);
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    
    /* Page Layout */
    .page {
      width: 210mm;
      min-height: 297mm;
      padding: var(--space-5);
      page-break-after: always;
      position: relative;
      margin: 0 auto;
    }
    
    /* Title Page Design */
    .title-page {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      min-height: 297mm;
      background-color: var(--white);
      padding: var(--space-8);
    }
    
    .title-page h1 {
      font-size: var(--text-4xl);
      color: var(--primary-dark);
      margin-bottom: var(--space-6);
      border: none;
      padding: 0;
      max-width: 80%;
      line-height: 1.2;
    }
    
    .title-page h2 {
      font-size: var(--text-2xl);
      color: var(--accent-green);
      margin-bottom: var(--space-8);
    }
    
    .title-details {
      margin-top: var(--space-8);
      font-size: var(--text-lg);
    }
    
    .title-details p {
      margin: var(--space-2) 0;
      line-height: 1.6;
    }
    
    /* Report Overview Page */
    .overview-page {
      padding: var(--space-6);
    }
    
    .info-block {
      background-color: var(--light-mint);
      border-left: 4pt solid var(--accent-green);
      padding: var(--space-4);
      margin-bottom: var(--space-4);
      border-radius: 4pt;
    }
    
    .info-block h3 {
      color: var(--primary-dark);
      margin-bottom: var(--space-3);
      font-size: var(--text-lg);
    }
    
    .info-row {
      display: flex;
      margin-bottom: var(--space-2);
      align-items: baseline;
    }
    
    .info-label {
      font-weight: 600;
      width: 150pt;
      flex-shrink: 0;
    }
    
    .info-value {
      flex: 1;
    }
    
    /* Section Headers */
    h1 {
      font-size: var(--text-3xl);
      color: var(--primary-dark);
      margin-bottom: var(--space-4);
      border-bottom: 2pt solid var(--accent-green);
      padding-bottom: var(--space-2);
    }
    
    h2 {
      font-size: var(--text-2xl);
      color: var(--accent-green);
      margin-top: var(--space-4);
      margin-bottom: var(--space-3);
    }
    
    h3 {
      font-size: var(--text-xl);
      color: var(--primary-dark);
      margin-top: var(--space-3);
      margin-bottom: var(--space-2);
    }
    
    /* Global Footer */
    @page {
      @bottom-center {
        content: "AI Efficiency Scorecard | Page " counter(page) " of " counter(pages);
        font-family: 'Plus Jakarta Sans', Arial, sans-serif;
        font-size: var(--text-xs);
        color: var(--primary-dark);
      }
      margin: var(--space-4);
    }
    
    /* Print-Specific Styles */
    @media print {
      body {
        margin: 0;
        padding: 0;
      }
      
      .page {
        height: 100vh;
        box-sizing: border-box;
      }
      
      /* Critical for avoiding unwanted page breaks */
      .no-break {
        page-break-inside: avoid !important;
      }
      
      /* Ensure headers don't break across pages */
      h1, h2, h3 {
        page-break-after: avoid;
        page-break-before: auto;
      }
      
      /* Ensure long paragraphs don't get cut off */
      p {
        orphans: 3;
        widows: 3;
      }
    }

    /* Cover Page Design */
    .cover {
      display: flex;
      flex-direction: column;
      justify-content: center;
      background-color: #f5f7fa;
      text-align: center;
      padding: 40mm 20mm;
      height: 100%;
      border-left: 15pt solid #20E28F;
    }
    
    .cover h1 {
      font-size: 32pt;
      color: #2c3e50;
      margin-bottom: 25pt;
    }
    
    .cover h2 {
      font-size: 24pt;
      color: #20E28F;
      margin-bottom: 40pt;
    }
    
    .cover-details {
      margin-top: 40pt;
      font-size: 14pt;
    }
    
    .cover-details p {
      margin: 8pt 0;
    }
    
    /* Two Column Layout */
    .two-column {
      display: flex;
      flex-wrap: wrap;
      gap: 20pt;
      margin: 15pt 0;
    }
    
    .two-column > div {
      flex: 1 1 45%;
    }
    
    /* Two Column Grid for Action Plans */
    .two-column-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15pt;
    }
    
    /* Action Plan Styling */
    .action-item {
      display: flex;
      gap: 15pt;
      margin-bottom: 20pt;
      background-color: #f9f9f9;
      padding: 15pt;
      border-radius: 5pt;
      border-left: 5pt solid #20E28F;
      page-break-inside: avoid;
      box-shadow: 0 2pt 5pt rgba(0,0,0,0.05);
    }
    
    .action-plan-container {
      margin-top: 20pt;
      min-height: 400pt;
    }
    
    .action-number {
      font-size: 28pt;
      font-weight: bold;
      color: #20E28F;
      min-width: 40pt;
      text-align: center;
    }
    
    .action-content h3 {
      font-size: 14pt;
      margin-top: 0;
      margin-bottom: 8pt;
      color: #2c3e50;
    }
    
    .compact-list {
      margin: 0;
      padding-left: 15pt;
    }
    
    .compact-list li {
      margin-bottom: 5pt;
      font-size: 11pt;
    }
    
    /* Table Styling */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20pt 0;
    }
    
    th, td {
      border: 1pt solid #ddd;
      padding: 10pt;
      text-align: left;
    }
    
    th {
      background-color: #20E28F;
      color: white;
      font-weight: bold;
    }
    
    tr:nth-child(even) {
      background-color: #f5f5f5;
    }
    
    /* Strengths and Weaknesses */
    .strength-item, .weakness-item {
      margin-bottom: 15pt;
      padding: 10pt;
      background-color: #f9f9f9;
      border-radius: 5pt;
    }
    
    .strength-item {
      border-left: 5pt solid #20E28F;
    }
    
    .weakness-item {
      border-left: 5pt solid #ff6b6b;
    }
    
    /* Logo Styling */
    .logo-container {
      margin-bottom: 30pt;
      text-align: center;
    }
    
    .logo-container svg {
      width: 180pt;
      height: auto;
    }

    /* Contact Details Section */
    .contact-section {
      margin-top: 20pt;
      padding-top: 15pt;
      border-top: 1pt solid #ddd;
    }
    
    .contact-heading {
      font-size: 16pt;
      margin-bottom: 10pt;
      color: #2c3e50;
    }
    
    .office-locations {
      display: flex;
      flex-wrap: wrap;
      gap: 20pt;
    }
    
    .office {
      flex: 1 1 45%;
      margin-bottom: 15pt;
    }
    
    .office h4 {
      font-size: 14pt;
      color: #20E28F;
      margin-bottom: 5pt;
    }
    
    .office p {
      margin: 0;
      line-height: 1.4;
    }
    
    .phone-number {
      font-size: 14pt;
      font-weight: bold;
      margin-top: 10pt;
    }
    
    /* Detailed Analysis Specific Styles */
    .detailed-analysis-content .dimension-block {
      margin-bottom: 20pt;
      padding: 10pt;
      border: 1px solid #eee;
      border-radius: 5pt;
      background-color: #fdfdfd;
      page-break-inside: avoid;
      height: fit-content;
      overflow: hidden;
    }

    .detailed-analysis-content.two-column-grid .dimension-block {
      display: flex;
      flex-direction: column;
      height: 100%;
      font-size: 10pt; /* Slightly smaller font for two column layout */
    }
    
    .detailed-analysis-content.two-column-grid h4 {
      font-size: 12pt;
      margin-bottom: 8pt;
    }
    
    .detailed-analysis-content.two-column-grid h5 {
      font-size: 11pt;
      margin-bottom: 4pt;
    }
    
    .detailed-analysis-content.two-column-grid p {
      margin-bottom: 6pt;
      line-height: 1.4;
    }

    .detailed-analysis-content .dimension-title {
      margin-bottom: 10pt;
      padding-bottom: 3pt;
      border-bottom: 1px solid #eee;
    }

    .detailed-analysis-content .dimension-intro {
      margin-bottom: 10pt;
      font-style: italic;
      color: #555;
    }

    .detailed-analysis-content .strength-item h5,
    .detailed-analysis-content .weakness-item h5 {
      margin-top: 0;
    }
    
    .detailed-analysis-content .strength-item p,
    .detailed-analysis-content .weakness-item p {
        margin-bottom: 5pt;
    }

    .detailed-recommendation-item {
      margin-bottom: 15pt;
      padding: 10pt;
      background-color: #f0f9ff;
      border-left: 5pt solid #01CEFE;
      border-radius: 5pt;
    }

    .detailed-recommendation-item h5 {
      color: #01579b;
      margin-top: 0;
    }

    .detailed-recommendation-item ul {
      margin-left: 15pt;
      margin-bottom: 0;
    }

    .detailed-recommendation-item li {
      margin-bottom: 5pt;
      font-size: 11pt;
    }

    /* Page intro text */
    .page-intro {
      font-style: italic;
      color: #555;
      margin-bottom: 20pt;
    }

    /* Content Sections */
    .content-section {
      margin-bottom: var(--space-4);
    }
    
    .content-box {
      background-color: var(--light-mint);
      border-left: 4pt solid var(--accent-green);
      padding: var(--space-4);
      margin-bottom: var(--space-4);
      border-radius: 4pt;
    }
    
    /* Ensure proper content distribution */
    .action-plan-container,
    .detailed-analysis-content,
    .learning-path-container {
      min-height: 200mm;
    }
    
    /* Table Styling */
    .qa-table {
      width: 100%;
      border-collapse: collapse;
      margin: var(--space-4) 0;
    }
    
    .qa-table th,
    .qa-table td {
      border: 1pt solid #ddd;
      padding: var(--space-2);
      text-align: left;
      font-size: var(--text-sm);
    }
    
    .qa-table th {
      background-color: var(--accent-green);
      color: var(--white);
      font-weight: bold;
    }
    
    .qa-table tr:nth-child(even) {
      background-color: #f5f5f5;
    }
    
    /* Ensure table rows don't break across pages */
    .qa-table tr {
      page-break-inside: avoid;
    }
    
    /* Strengths and Challenges Styling */
    .strengths-container,
    .weaknesses-container {
      display: flex;
      flex-direction: column;
      gap: var(--space-3);
      padding: var(--space-4);
      margin-bottom: var(--space-4);
    }

    .strengths-content,
    .weaknesses-content {
      display: flex;
      flex-direction: column;
      gap: var(--space-3);
    }

    .strength-item,
    .weakness-item {
      padding: var(--space-3);
      border-radius: 4pt;
      background-color: var(--white);
      box-shadow: 0 1pt 3pt rgba(0, 0, 0, 0.1);
      page-break-inside: avoid;
      margin-bottom: var(--space-3);
    }

    .strength-item {
      border-left: 4pt solid var(--accent-green);
    }

    .weakness-item {
      border-left: 4pt solid #ff6b6b;
    }

    .strength-item h5,
    .weakness-item h5 {
      color: var(--primary-dark);
      font-size: var(--text-lg);
      margin-bottom: var(--space-2);
      font-weight: 600;
    }

    .strength-item p,
    .weakness-item p {
      color: var(--primary-dark);
      font-size: var(--text-base);
      line-height: 1.5;
      margin: 0;
    }

    /* Action Plan Styling */
    .action-plan-container {
      display: flex;
      flex-direction: column;
      gap: var(--space-4);
    }

    .action-item {
      display: flex;
      gap: var(--space-3);
      padding: var(--space-4);
      background-color: var(--white);
      border-radius: 4pt;
      border-left: 4pt solid var(--accent-green);
      box-shadow: 0 1pt 3pt rgba(0, 0, 0, 0.1);
      page-break-inside: avoid;
      margin-bottom: var(--space-4);
    }

    .action-number {
      font-size: var(--text-2xl);
      font-weight: bold;
      color: var(--accent-green);
      min-width: 40pt;
      text-align: center;
    }

    .action-content {
      flex: 1;
    }

    .action-content h3 {
      color: var(--primary-dark);
      font-size: var(--text-xl);
      margin-bottom: var(--space-3);
    }

    .action-content ul {
      margin: 0;
      padding-left: var(--space-4);
    }

    .action-content li {
      margin-bottom: var(--space-2);
      color: var(--primary-dark);
    }

    /* Page Intro */
    .page-intro {
      font-style: italic;
      color: var(--primary-dark);
      margin-bottom: var(--space-4);
      font-size: var(--text-base);
      line-height: 1.5;
    }
  </style>
  
  <script type="text/javascript">
    window.addEventListener('load', function() {
      // Check if there are any action items
      var actionContainer = document.querySelector('.action-plan-container');
      var fallbackMessage = document.querySelector('.no-action-plan-fallback');
      
      if (actionContainer && fallbackMessage) {
        // If the container has only a paragraph with the error message
        if (actionContainer.innerHTML.indexOf('No action plan detailed in the expected format') !== -1) {
          // Show the fallback message
          fallbackMessage.style.display = 'block';
          // Hide the container with the error
          actionContainer.style.display = 'none';
        }
      }
    });
  </script>
</head>

<body>
  <!-- Title Page -->
  <div class="page title-page">
    <div class="logo-container">
      <img src="/footer-logo.svg" alt="AI Efficiency Scorecard Logo" width="150" height="30" />
    </div>
    <h1>AI Efficiency Scorecard for Property/Real Estate</h1>
    <div class="title-details">
      <p>Prepared for: Property/Real Estate Industry</p>
      <p>Report Date: {{ReportDate}}</p>
      <p>Report ID: {{ReportID}}</p>
    </div>
  </div>

  <!-- Report Overview & User Details -->
  <div class="page overview-page">
    <h1>Report Overview & User Details</h1>
    
    <div class="info-block no-break">
      <h3>User Information</h3>
      <p>User Name: {{UserName}}</p>
      <p>Company Name: {{CompanyName}}</p>
      <p>Industry: {{Industry}}</p>
      <p>Email: {{UserEmail}}</p>
    </div>
    
    <div class="info-block no-break">
      <h3>Score Information</h3>
      <p>AI Tier: {{AITier}}</p>
      <p>Final Score: {{FinalScore}}</p>
      <p>Report ID: {{ReportID}}</p>
    </div>
    
    <div class="info-block no-break">
      <h3>About This Report</h3>
      <p>This comprehensive assessment provides detailed insights into your organization's current AI maturity level and strategic opportunities for advancement. The following pages contain:</p>
      <ul>
        <li>Overall tier and its implications for your business</li>
        <li>Key strengths identified in your AI adoption journey</li>
        <li>Critical challenges and areas for improvement</li>
        <li>Strategic action plan with prioritized recommendations</li>
        <li>Detailed analysis of each assessment dimension</li>
        <li>Industry benchmarks and comparative insights</li>
        <li>Personalized learning path and resources</li>
      </ul>
    </div>
  </div>

  <!-- Overall Tier -->
  <div class="page">
    <h1>Overall Tier: {{AITier}}</h1>
    
    <div class="score-box content-box no-break">
      <h3>Score: {{FinalScore}}</h3>
      <p>This score is calculated based on your responses to the AI efficiency assessment, evaluating multiple dimensions of AI readiness and implementation.</p>
    </div>

    <div class="content-box no-break">
      <h2>Current Standing</h2>
      <p>As a {{AITier}}, your organization is beginning to experiment with AI technologies. This stage is characterized by initial exploration and basic implementation of AI solutions, typically with limited strategic integration.</p>
    </div>

    <div class="content-box no-break">
      <h2>What This Means for Your Business</h2>
      <p>Your current position presents both opportunities and challenges. While you have taken the first steps toward AI adoption, there is significant potential for growth and optimization. The recommendations in this report will help guide your journey toward more advanced AI maturity.</p>
    </div>
  </div>

  <!-- Key Findings -->
  <div class="page">
    <h1>Key Findings</h1>
    
    <div class="strengths-container content-box no-break">
      <h2>Strengths</h2>
      <div class="strengths-content">
        {{{STRENGTHS_CONTENT}}}
      </div>
    </div>
  </div>

  <div class="page">
    <h1>Challenges</h1>
    
    <div class="weaknesses-container content-box no-break">
      <div class="weaknesses-content">
        {{{CHALLENGES_CONTENT}}}
      </div>
    </div>
  </div>

  <!-- Strategic Action Plan -->
  <div class="page">
    <h1>Strategic Action Plan</h1>
    <p class="page-intro">These recommendations are designed to help you improve your AI maturity and achieve your business objectives.</p>
    
    <div class="action-plan-container">
      {{{ACTION_PLAN_CONTENT_PART_1}}}
    </div>
  </div>

  <div class="page">
    {{{ACTION_PLAN_CONTENT_PART_2}}}
  </div>

  <div class="page">
    {{{ACTION_PLAN_CONTENT_PART_3}}}
  </div>

  <!-- Detailed Analysis -->
  <div class="page">
    <h1>Detailed Analysis</h1>
    
    <div class="detailed-analysis-content">
      {{{DETAILED_ANALYSIS_CONTENT_PART_1}}}
    </div>
  </div>

  <div class="page">
    <div class="detailed-analysis-content">
      {{{DETAILED_ANALYSIS_CONTENT_PART_2}}}
    </div>
  </div>

  <div class="page">
    <div class="detailed-analysis-content">
      {{{DETAILED_ANALYSIS_CONTENT_PART_3}}}
    </div>
  </div>

  <div class="page">
    <div class="detailed-analysis-content">
      {{{DETAILED_ANALYSIS_CONTENT_PART_4}}}
    </div>
  </div>

  <!-- Assessment Responses -->
  <div class="page">
    <h1>Assessment Responses</h1>
    
    <table class="qa-table">
      <thead>
        <tr>
          <th>Category</th>
          <th>Question</th>
          <th>Response</th>
        </tr>
      </thead>
      <tbody>
        {{{QA_CONTENT_PART_1}}}
      </tbody>
    </table>
  </div>

  <div class="page">
    <table class="qa-table">
      <thead>
        <tr>
          <th>Category</th>
          <th>Question</th>
          <th>Response</th>
        </tr>
      </thead>
      <tbody>
        {{{QA_CONTENT_PART_2}}}
      </tbody>
    </table>
  </div>

  <!-- Recommended Learning Path -->
  <div class="page">
    <h1>Recommended Learning Path</h1>
    
    <div class="learning-path-container">
      {{{LEARNING_PATH_CONTENT_PART_1}}}
    </div>
  </div>

  <div class="page">
    <div class="learning-path-container">
      {{{LEARNING_PATH_CONTENT_PART_2}}}
    </div>
  </div>

  <!-- Contact Information (Page 17) -->
  <div class="page">
    <h1>Contact Information</h1>
    <div class="contact-section">
      <h3 class="contact-heading">For further discussion or implementation support, please contact us.</h3>
      <p>Social Garden<br>
      {{UserEmail}}</p>
      
      <div class="office-locations">
        <div class="office">
          <h4>Melbourne</h4>
          <p>Level 8, The Hive Abbotsford,<br>
          222 Hoddle St. Collingwood 3067</p>
        </div>
        
        <div class="office">
          <h4>Auckland</h4>
          <p>268 Karangahape Road,<br>
          Auckland CBD,<br>
          Auckland</p>
        </div>
        
        <div class="office">
          <h4>Sydney</h4>
          <p>Level 3, 100 Harris Street<br>
          Pyrmont, NSW.<br>
          Australia 2009</p>
        </div>
        
        <div class="office">
          <h4>Brisbane</h4>
          <p>310 Edward St,<br>
          Brisbane City, QLD.<br>
          Australia 4000</p>
        </div>
      </div>
      
      <p class="phone-number">1800 771 396</p>
    </div>
  </div>
</body>
</html> 